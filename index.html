<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlockLua | Kod Yazma, Sanat Yap</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/blockly/blockly.min.js"></script>
    <script src="https://unpkg.com/blockly/lua_compressed.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        * { font-family: 'Inter', sans-serif; box-sizing: border-box; }

        body { background: #0f172a; color: #f8f9fa; margin: 0; height: 100vh; overflow: hidden; }

        /* Cam Efekti */
        .glass {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(16px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* YÃ¼kleme EkranÄ± TasarÄ±mÄ± */
        #loader {
            position: fixed; inset: 0; background: #0f172a;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 10000; transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .loader-bar-bg {
            width: 240px; height: 4px; background: rgba(255, 255, 255, 0.05);
            border-radius: 10px; margin-top: 25px; overflow: hidden;
        }

        #progress {
            width: 0%; height: 100%;
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
            /* Transition JS iÃ§inden kontrol edilecek */
        }

        .pulse-box {
            font-size: 60px; filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.3));
            animation: pulse-slow 3s infinite ease-in-out;
        }

        @keyframes pulse-slow {
            0%, 100% { transform: scale(1); opacity: 0.9; }
            50% { transform: scale(1.05); opacity: 1; }
        }

        /* Blockly Ã–zelleÅŸtirme */
        .blocklyTreeLabel { color: #94a3b8 !important; font-size: 13px !important; }
        .blocklyToolboxContents { background-color: #1e293b !important; padding: 10px !important; }
        .blocklyMainBackground { stroke: none !important; fill: #0f172a !important; }
        
        #luaCode { scrollbar-width: thin; scrollbar-color: #334155 transparent; }
        #luaCode::-webkit-scrollbar { width: 5px; }
        #luaCode::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }

        /* BaÅŸarÄ± Bildirimi */
        #toast {
            position: fixed; top: 20px; right: 20px;
            background: #10b981; color: white; padding: 12px 24px;
            border-radius: 12px; font-weight: 600; display: none;
            z-index: 10001; box-shadow: 0 10px 25px rgba(16, 185, 129, 0.2);
        }
    </style>
</head>
<body>

    <div id="loader">
        <div class="pulse-box">ðŸ“¦</div>
        <h1 class="mt-6 text-2xl font-light tracking-[0.3em] text-white">BLOCK<span class="font-bold text-blue-500">LUA</span></h1>
        <p class="text-xs text-gray-500 mt-2 tracking-widest uppercase">Kod yazma, sanat yap</p>
        <div class="loader-bar-bg">
            <div id="progress"></div>
        </div>
    </div>

    <div id="toast" class="animate__animated">Kod KopyalandÄ±! âœ¨</div>

    <header class="h-16 glass flex items-center justify-between px-8 relative z-50">
        <div class="flex items-center gap-4">
            <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-700 rounded-xl flex items-center justify-center text-xl">ðŸ“¦</div>
            <div>
                <h1 class="font-bold text-lg leading-none tracking-tight">BlockLua</h1>
                <p class="text-[10px] text-blue-400 font-bold tracking-[0.2em] uppercase mt-1">SÃ¼rÃ¼m 2.6</p>
            </div>
        </div>
        <div class="flex items-center gap-4">
            <button onclick="copyCode()" class="px-6 py-2 bg-blue-600 hover:bg-blue-500 rounded-full text-sm font-semibold transition-all hover:scale-105 active:scale-95 shadow-lg shadow-blue-600/20">
                Kodu Kopyala
            </button>
        </div>
    </header>

    <main class="flex-1 flex overflow-hidden">
        <div id="blocklyDiv" class="flex-1"></div>
        <aside class="w-[380px] glass border-l border-white/5 flex flex-col shadow-2xl">
            <div class="p-4 flex items-center justify-between border-b border-white/5 bg-white/5">
                <span class="text-[11px] font-bold text-gray-400 uppercase tracking-widest">CanlÄ± Lua Ã‡Ä±ktÄ±sÄ±</span>
            </div>
            <pre id="luaCode" class="flex-1 p-6 font-mono text-sm leading-relaxed text-blue-300/80 overflow-auto bg-[#0a0f1a]">-- BloklarÄ± sÃ¼rÃ¼kle...</pre>
        </aside>
    </main>

    <xml id="toolbox" style="display: none">
        <category name="ðŸš€ BaÅŸlatÄ±cÄ±lar" colour="#6366f1">
            <block type="on_start"></block>
            <block type="on_button_click"></block>
        </category>
        <category name="âš™ï¸ Fonksiyonlar" colour="#ec4899">
            <block type="http_get"></block>
            <block type="print_text"></block>
        </category>
        <category name="ðŸŽ® Karakter" colour="#10b981">
            <block type="set_speed"></block>
        </category>
    </xml>

    <script>
        // BLOK TANIMLARI
        Blockly.Blocks['on_start'] = { init: function() { this.appendDummyInput().appendField("ðŸš€ Script BaÅŸlatÄ±ldÄ±ÄŸÄ±nda"); this.appendStatementInput("DO"); this.setColour(230); } };
        Blockly.Blocks['on_button_click'] = { init: function() { this.appendDummyInput().appendField("ðŸ”˜ Butona TÄ±klanÄ±nca"); this.appendStatementInput("DO"); this.setColour(230); } };
        Blockly.Blocks['http_get'] = { init: function() { this.appendDummyInput().appendField("ðŸŒ Link Ã‡alÄ±ÅŸtÄ±r").appendField(new Blockly.FieldTextInput("https://..."), "URL"); this.setPreviousStatement(true); this.setNextStatement(true); this.setColour(300); } };
        Blockly.Blocks['print_text'] = { init: function() { this.appendDummyInput().appendField("ðŸ’¬ YazdÄ±r").appendField(new Blockly.FieldTextInput("Mesaj"), "TEXT"); this.setPreviousStatement(true); this.setNextStatement(true); this.setColour(160); } };
        Blockly.Blocks['set_speed'] = { init: function() { this.appendDummyInput().appendField("ðŸƒ HÄ±zÄ± Ayarla").appendField(new Blockly.FieldNumber(16), "SPEED"); this.setPreviousStatement(true); this.setNextStatement(true); this.setColour(120); } };

        // GENERATOR
        javascript.luaGenerator.forBlock['on_start'] = function(block) { return '-- [ BlockLua ]\n' + javascript.luaGenerator.statementToCode(block, 'DO'); };
        javascript.luaGenerator.forBlock['on_button_click'] = function(block) { return 'Button.MouseButton1Click:Connect(function()\n' + javascript.luaGenerator.statementToCode(block, 'DO') + 'end)\n'; };
        javascript.luaGenerator.forBlock['http_get'] = function(block) { return 'loadstring(game:HttpGet("' + block.getFieldValue('URL') + '"))()\n'; };
        javascript.luaGenerator.forBlock['print_text'] = function(block) { return 'print("' + block.getFieldValue('TEXT') + '")\n'; };
        javascript.luaGenerator.forBlock['set_speed'] = function(block) { return 'game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = ' + block.getFieldValue('SPEED') + '\n'; };

        // INITIALIZE
        let workspace;
        window.addEventListener('DOMContentLoaded', () => {
            const progress = document.getElementById('progress');
            const loader = document.getElementById('loader');
            
            // Ã‡ubuÄŸu %100'e zorla Ã§ek
            setTimeout(() => {
                progress.style.transition = 'width 1.2s ease-in-out';
                progress.style.width = '100%';
            }, 100);

            // EkranÄ± kesin olarak aÃ§
            setTimeout(() => {
                loader.style.opacity = '0';
                loader.style.transform = 'scale(1.05)';
                setTimeout(() => { 
                    loader.style.display = 'none'; 
                    Blockly.svgResize(workspace);
                }, 800);
            }, 1500);

            workspace = Blockly.inject('blocklyDiv', {
                toolbox: document.getElementById('toolbox'),
                theme: Blockly.Themes.Dark,
                renderer: 'zelos',
                zoom: { controls: true, wheel: true, startScale: 0.9 }
            });

            workspace.addChangeListener(() => {
                const code = javascript.luaGenerator.workspaceToCode(workspace);
                document.getElementById('luaCode').innerText = code || "-- SanatÄ±na baÅŸla...";
            });
        });

        function copyCode() {
            const code = document.getElementById('luaCode').innerText;
            const toast = document.getElementById('toast');
            navigator.clipboard.writeText(code).then(() => {
                toast.style.display = 'block';
                toast.classList.add('animate__fadeInDown');
                setTimeout(() => {
                    toast.classList.replace('animate__fadeInDown', 'animate__fadeOutUp');
                    setTimeout(() => { toast.style.display = 'none'; toast.classList.remove('animate__fadeOutUp'); }, 500);
                }, 2000);
            });
        }
    </script>
</body>
</html>
