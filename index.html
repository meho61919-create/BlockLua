<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlockLua | Kod Yazma, Sanat Yap</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/blockly/blockly.min.js"></script>
    <script src="https://unpkg.com/blockly/lua_compressed.js"></script>
    
    <style>
        .blocklyTreeLabel { color: #d1d5db !important; font-size: 14px; }
        .blocklyToolboxContents { background-color: #1f2937; padding: 8px; }
        .blocklyMainBackground { stroke: #374151 !important; stroke-width: 1; }
    </style>
</head>
<body class="bg-[#111827] text-gray-100 h-screen flex flex-col overflow-hidden">

    <header class="h-14 border-b border-gray-800 flex items-center justify-between px-6 bg-[#1f2937]">
        <div class="flex items-center gap-3">
            <span class="text-2xl">ðŸ“¦</span>
            <h1 class="font-bold text-xl tracking-tight">Block<span class="text-blue-400">Lua</span></h1>
            <span class="text-xs bg-gray-700 px-2 py-1 rounded text-gray-400 ml-2 uppercase tracking-widest">Beta v1.0</span>
        </div>
        <div class="flex gap-4">
            <button class="text-sm bg-blue-600 hover:bg-blue-500 px-4 py-1.5 rounded-lg transition" onclick="copyCode()">Kodu Kopyala</button>
            <button class="text-sm border border-gray-600 hover:bg-gray-700 px-4 py-1.5 rounded-lg transition">Temizle</button>
        </div>
    </header>

    <main class="flex-1 flex overflow-hidden">
        
        <div id="blocklyDiv" class="flex-1 h-full"></div>

        <aside class="w-80 border-l border-gray-800 bg-[#0b0f1a] flex flex-col">
            <div class="p-3 border-b border-gray-800 bg-[#1f2937] text-xs font-semibold text-gray-400 uppercase tracking-wider">
                CanlÄ± Lua Ã‡Ä±ktÄ±sÄ±
            </div>
            <pre id="luaCode" class="p-4 text-blue-300 font-mono text-sm overflow-auto flex-1 leading-relaxed">
-- BloklarÄ± buraya sÃ¼rÃ¼kleyin...</pre>
        </aside>

    </main>

    <xml id="toolbox" style="display: none">
        <category name="ðŸ› ï¸ BaÅŸlatÄ±cÄ±lar" colour="#5b67a5">
            <block type="on_start"></block>
            <block type="on_button_click"></block>
        </category>
        <category name="ðŸ”¥ Aksiyonlar" colour="#995ba5">
            <block type="http_get"></block>
            <block type="print_text"></block>
        </category>
        <category name="âš¡ Ã–zellikler" colour="#5ba5a5">
            <block type="set_speed"></block>
        </category>
    </xml>

    <script>
        // 1. BLOK MANTIÄžI (Ã–ZEL)
        Blockly.Blocks['on_start'] = {
            init: function() {
                this.appendDummyInput().appendField("ðŸš€ Script BaÅŸlatÄ±ldÄ±ÄŸÄ±nda");
                this.appendStatementInput("DO").setCheck(null);
                this.setColour(230);
            }
        };

        Blockly.Blocks['http_get'] = {
            init: function() {
                this.appendDummyInput().appendField("ðŸ”— DÄ±ÅŸarÄ±dan Link Ã‡alÄ±ÅŸtÄ±r")
                    .appendField(new Blockly.FieldTextInput("https://link.com"), "URL");
                this.setPreviousStatement(true, null);
                this.setNextStatement(true, null);
                this.setColour(290);
            }
        };

        // 2. LUA ÃœRETÄ°CÄ°SÄ°
        javascript.luaGenerator.forBlock['on_start'] = function(block) {
            var branch = javascript.luaGenerator.statementToCode(block, 'DO');
            return '-- BlockLua Generated Script\nprint("Script Aktif!")\n' + branch;
        };

        javascript.luaGenerator.forBlock['http_get'] = function(block) {
            var url = block.getFieldValue('URL');
            return 'loadstring(game:HttpGet("' + url + '"))()\n';
        };

        // 3. BAÅžLAT
        const workspace = Blockly.inject('blocklyDiv', {
            toolbox: document.getElementById('toolbox'),
            theme: Blockly.Themes.Dark,
            renderer: 'zelos' // Profesyonel kavisli blok gÃ¶rÃ¼nÃ¼mÃ¼
        });

        workspace.addChangeListener(() => {
            const code = javascript.luaGenerator.workspaceToCode(workspace);
            document.getElementById('luaCode').innerText = code || "-- HazÄ±r mÄ±sÄ±n? SanatÄ±na baÅŸla.";
        });

        function copyCode() {
            const code = document.getElementById('luaCode').innerText;
            navigator.clipboard.writeText(code);
            alert("Kod baÅŸarÄ±yla kopyalandÄ±!");
        }
    </script>
</body>
</html>
